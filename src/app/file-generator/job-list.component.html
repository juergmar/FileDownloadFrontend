<p-card header="Recent Jobs" styleClass="mt-3">
  <div class="jobs-header">
    <p-button
      icon="pi pi-refresh"
      styleClass="p-button-outlined p-button-sm"
      pTooltip="Refresh job list"
      (onClick)="onRefreshClicked()"
    ></p-button>
  </div>

  <p-table [value]="jobs" [loading]="loading" styleClass="p-datatable-sm" responsiveLayout="stack">
    <ng-template pTemplate="header">
      <tr>
        <th>Type</th>
        <th>File Name</th>
        <th>Status</th>
        <th>Created</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-job>
      <tr>
        <td>
          <span class="p-column-title">Type</span>
          {{ job.fileType | fileType }}
        </td>
        <td>
          <span class="p-column-title">File Name</span>
          {{ job.fileName || 'Pending...' }}
        </td>
        <td>
          <span class="p-column-title">Status</span>
          <p-tag
            [value]="job.status | jobStatus"
            [severity]="getStatusSeverity(job.status)"
          ></p-tag>
        </td>
        <td>
          <span class="p-column-title">Created</span>
          {{ job.createdAt | date:'medium' }}
        </td>
        <td>
          <div class="job-actions">
            <p-button
              icon="pi pi-download"
              styleClass="p-button-success p-button-sm mr-2"
              [disabled]="job.status !== 'COMPLETED'"
              pTooltip="Download"
              (onClick)="onDownloadClicked(job.jobId)"
            ></p-button>

            <p-button
              icon="pi pi-times"
              styleClass="p-button-danger p-button-sm mr-2"
              [disabled]="!isJobInProgress(job)"
              pTooltip="Cancel"
              (onClick)="onCancelClicked(job.jobId)"
            ></p-button>

            <p-button
              icon="pi pi-refresh"
              styleClass="p-button-warning p-button-sm"
              [disabled]="job.status !== 'FAILED'"
              pTooltip="Retry"
              (onClick)="onRetryClicked(job.jobId)"
            ></p-button>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="5" class="text-center">
          No recent jobs found
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>
